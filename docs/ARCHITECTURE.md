# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦: ã‚µãƒ¼ãƒãƒ¼ vs ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè²¬ä»»åˆ†æ‹…

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ãƒ–ãƒ©ã‚¦ã‚¶ (Client Side)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           SolidJS App (packages/agent/src/)               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  App.tsx                                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ç®¡ç† (messages, mcps, user)          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                    â”‚                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  api-client.ts                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç† (localStorage)                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°                                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/JSON (fetch API)
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Vite Dev Proxy (é–‹ç™ºæ™‚)    â”‚
        â”‚  :3000 â†’ :8787/api          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Cloudflare Workers (Server Side)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        packages/agent/worker/index.ts (Hono)              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  API Endpoints                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  POST /api/agent/chat  â—„â”€â”€â”€ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®å…¥åŠ›  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  GET  /api/user/me                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  POST /api/mcp/search                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  POST /api/mcp/link                                 â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                    â”‚                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  graph/ (LangGraph Agent)                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  InputNode â†’ PlanningNode (OpenAI LLM)        â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚       â†“           â†“                            â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  ToolExecutionNode â† (ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯)            â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚       â†“                                        â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  SynthesisNode â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹                   â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Built-in Tools:                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - search_mcp_servers                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - add_mcp_server                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - list_my_mcp_servers                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - remove_mcp_server                                 â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                    â”‚                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Prisma Client (D1 Database)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - User, AgentSession, ConversationMessage          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - AgentMcpLink, McpServer                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - OAuthAccount                                     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  OpenAI API                 â”‚
        â”‚  - gpt-4o-mini              â”‚
        â”‚  - Tool calling             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š è²¬ä»»åˆ†æ‹…ã®è©³ç´°

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ (SolidJS)

#### âœ… æ‹…å½“ç¯„å›²
1. **UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°**
   - ãƒãƒ£ãƒƒãƒˆç”»é¢ã®è¡¨ç¤º
   - MCP ç®¡ç†ç”»é¢ã®è¡¨ç¤º
   - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®è¡¨ç¤º

2. **ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ç®¡ç†**
   ```typescript
   const [messages, setMessages] = createSignal<ConversationMessage[]>([]);
   const [user, setUser] = createSignal<User | null>(null);
   const [mcps, setMcps] = createSignal<AgentMcpLink[]>([]);
   ```

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†**
   - ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
   - ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   - ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡

4. **HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡**
   - `apiClient.sendChat()` - ã‚µãƒ¼ãƒãƒ¼ã«å…¥åŠ›ã‚’é€ä¿¡
   - `apiClient.searchMcps()` - MCP æ¤œç´¢
   - `apiClient.linkMcp()` - MCP è¿½åŠ 

5. **èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**
   ```typescript
   localStorage.setItem('auth_token', token);
   headers['Authorization'] = `Bearer ${token}`;
   ```

#### âŒ æ‹…å½“å¤–ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ã§å®Ÿè¡Œï¼‰
- LLM ã¨ã®é€šä¿¡
- ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
- MCP ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡

---

### ã‚µãƒ¼ãƒãƒ¼å´ (Cloudflare Workers)

#### âœ… æ‹…å½“ç¯„å›²

1. **LangGraph Agent å®Ÿè¡Œ**
   ```typescript
   const graph = createAgentGraph({
     prisma,
     userId,
     openaiApiKey,
     mcpBaseUrl,
     serviceToken,
   });
   const graphState = await graph.invoke({ messages: [...] });
   ```

2. **OpenAI LLM ã¨ã®é€šä¿¡**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®è§£é‡ˆ
   - ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®åˆ¤å®š
   - æœ€çµ‚å›ç­”ã®ç”Ÿæˆ

3. **ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ**
   ```typescript
   // å†…è”µãƒ„ãƒ¼ãƒ«
   - search_mcp_servers: MCP API å‘¼ã³å‡ºã—
   - add_mcp_server: Prisma ã§ãƒªãƒ³ã‚¯ä½œæˆ
   - list_my_mcp_servers: Prisma ã§ã‚¯ã‚¨ãƒª
   - remove_mcp_server: Prisma ã§å‰Šé™¤/ç„¡åŠ¹åŒ–
   ```

4. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹**
   ```typescript
   // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
   await prisma.agentSession.create({ ... });
   
   // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜
   await prisma.conversationMessage.create({ ... });
   
   // MCP ãƒªãƒ³ã‚¯ç®¡ç†
   await prisma.agentMcpLink.findMany({ ... });
   ```

5. **MCP ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡**
   ```typescript
   const url = `${mcpBaseUrl}/mcp/discovery/search?...`;
   const response = await fetch(url, { headers });
   ```

6. **èªè¨¼ãƒ»èªå¯**
   ```typescript
   requireAuth([SCOPE_AGENT])  // JWT æ¤œè¨¼
   ```

#### âŒ æ‹…å½“å¤–ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å®Ÿè¡Œï¼‰
- UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ã‚­ãƒ£ãƒ—ãƒãƒ£
- ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ç®¡ç†
- ãƒ–ãƒ©ã‚¦ã‚¶ API ã®ä½¿ç”¨

---

## ğŸ”„ å…¸å‹çš„ãªãƒ•ãƒ­ãƒ¼

### ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› (Client)
   â””â”€â–º App.tsx: setInput(text)

2. é€ä¿¡ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ (Client)
   â””â”€â–º App.tsx: handleSend()
       â””â”€â–º messages ã«æ¥½è¦³çš„æ›´æ–°
       â””â”€â–º apiClient.sendChat({ input: text })

3. HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ (Client â†’ Server)
   â””â”€â–º POST /api/agent/chat
       Headers: Authorization: Bearer <token>
       Body: { input: "MCPã‚µãƒ¼ãƒãƒ¼ã‚’æ¤œç´¢ã—ã¦" }

4. ã‚µãƒ¼ãƒãƒ¼ã§å‡¦ç†é–‹å§‹ (Server)
   â””â”€â–º requireAuth() ã§èªè¨¼
   â””â”€â–º Prisma ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—/ä½œæˆ
   â””â”€â–º createAgentGraph() ã§ã‚°ãƒ©ãƒ•æ§‹ç¯‰

5. LangGraph å®Ÿè¡Œ (Server)
   â””â”€â–º InputNode: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¿½åŠ 
   â””â”€â–º PlanningNode: OpenAI ã«é€ä¿¡
       â””â”€â–º OpenAI: "search_mcp_servers ã‚’ä½¿ã†"
   â””â”€â–º ToolExecutionNode: ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
       â””â”€â–º fetch(`${mcpBaseUrl}/mcp/discovery/search`)
   â””â”€â–º PlanningNode: çµæœã‚’å—ã‘å–ã‚‹
   â””â”€â–º SynthesisNode: æœ€çµ‚å›ç­”ç”Ÿæˆ

6. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ (Server)
   â””â”€â–º ConversationMessage (user + assistant) ã‚’ä¿å­˜
   â””â”€â–º AgentSession ã® graphState ã‚’æ›´æ–°

7. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´ (Server â†’ Client)
   â””â”€â–º { sessionId, messages, response }

8. UI æ›´æ–° (Client)
   â””â”€â–º setMessages(response.messages)
   â””â”€â–º setSessionId(response.sessionId)
```

---

## ğŸ’¡ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

### âœ… ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯**å®Œå…¨ã«ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰**ã§å®Ÿè¡Œ

- **LLM å‘¼ã³å‡ºã—**: ã‚µãƒ¼ãƒãƒ¼å´ã®ã¿ï¼ˆOpenAI API Key ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«éœ²å‡ºã—ãªã„ï¼‰
- **ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ**: ã‚µãƒ¼ãƒãƒ¼å´ã®ã¿
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹**: ã‚µãƒ¼ãƒãƒ¼å´ã®ã¿
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**: ã‚µãƒ¼ãƒãƒ¼å´ã®ã¿

### âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯**ã‚·ãƒ³ãƒ—ãƒ«ãª UI ãƒ¬ã‚¤ãƒ¤ãƒ¼**

- HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã¿
- çŠ¶æ…‹ç®¡ç†ã¯è¡¨ç¤ºã®ãŸã‚ã ã‘
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãªã—

### âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

```typescript
// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: ãƒˆãƒ¼ã‚¯ãƒ³ã®ã¿ä¿æŒ
localStorage.setItem('auth_token', token);

// ã‚µãƒ¼ãƒãƒ¼: ã™ã¹ã¦ã®æ©Ÿå¯†æƒ…å ±ã‚’ä¿æŒ
OPENAI_API_KEY=sk-...
JWT_SECRET=...
MCP_SERVICE_TOKEN=...
```

### âœ… ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

- **Cloudflare Workers**: ã‚¨ãƒƒã‚¸ã§å®Ÿè¡Œã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹
- **D1 Database**: åˆ†æ•£ SQLiteã€ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼
- **OpenAI API**: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒ«

---

## ğŸ“ˆ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›
    â†“
[SolidJS App]
    â”œâ”€ UI æ›´æ–°ï¼ˆæ¥½è¦³çš„ï¼‰
    â””â”€ fetch('/api/agent/chat', { body: input })
         â†“
[Cloudflare Workers]
    â”œâ”€ èªè¨¼æ¤œè¨¼ (JWT)
    â”œâ”€ ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—/ä½œæˆ (Prisma)
    â”œâ”€ LangGraph å®Ÿè¡Œ
    â”‚   â”œâ”€ OpenAI LLM å‘¼ã³å‡ºã—
    â”‚   â”œâ”€ ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ (search_mcp_servers ãªã©)
    â”‚   â””â”€ æœ€çµ‚å›ç­”ç”Ÿæˆ
    â”œâ”€ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜ (Prisma)
    â””â”€ ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´
         â†“
[SolidJS App]
    â””â”€ messages æ›´æ–°ã€UI å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
```

---

## ğŸ¯ ã¾ã¨ã‚

### Agent ã¯**å®Œå…¨ã«ã‚µãƒ¼ãƒãƒ¼ã§å‹•ä½œ**ã—ã¦ã„ã¾ã™ï¼

| å‡¦ç† | å®Ÿè¡Œå ´æ‰€ | ç†ç”± |
|------|---------|------|
| LangGraph orchestration | âš¡ **Server** | LLM API Key ã®ä¿è­·ã€å‡¦ç†èƒ½åŠ› |
| OpenAI LLM å‘¼ã³å‡ºã— | âš¡ **Server** | API Key ã®ä¿è­· |
| ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ | âš¡ **Server** | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹å¿…è¦ |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒª | âš¡ **Server** | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ |
| UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° | ğŸ’» **Client** | ãƒ–ãƒ©ã‚¦ã‚¶ã®ä»•äº‹ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ› | ğŸ’» **Client** | ãƒ–ãƒ©ã‚¦ã‚¶ã®ä»•äº‹ |
| ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜ | ğŸ’» **Client** | localStorage |

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®é–¢ä¸ã¯æœ€å°é™**ã§ã€ä¸»ã«ä»¥ä¸‹ã®ã¿:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ã‚­ãƒ£ãƒ—ãƒãƒ£
2. HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¡¨ç¤º

ã™ã¹ã¦ã®ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªå‡¦ç†ï¼ˆLLMã€ãƒ„ãƒ¼ãƒ«ã€åˆ¤æ–­ï¼‰ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Š:
- ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒç¢ºä¿ã•ã‚Œã‚‹ï¼ˆAPI Key æ¼æ´©ãªã—ï¼‰
- ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šï¼ˆã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰
- ğŸ§© ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹

ã“ã‚Œã¯**å…¸å‹çš„ãª BFF (Backend for Frontend) ãƒ‘ã‚¿ãƒ¼ãƒ³**ã§ã€ç¾ä»£çš„ãª Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã™ï¼
